#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Hook executado apÃ³s cada commit
echo "ğŸ“ Executando aÃ§Ãµes pÃ³s-commit..."

# Verificar se Ã© um commit de merge
if git log -1 --pretty=%B | grep -q "Merge"; then
  echo "ğŸ”€ Commit de merge detectado, pulando aÃ§Ãµes automÃ¡ticas."
  exit 0
fi

# Verificar se Ã© um commit de release
if git log -1 --pretty=%B | grep -qE "^(release|chore\(release\)|v[0-9]+\.[0-9]+\.[0-9]+)"; then
  echo "ğŸš€ Commit de release detectado, pulando aÃ§Ãµes automÃ¡ticas."
  exit 0
fi

# Gerar informaÃ§Ãµes de build
echo "ğŸ”§ Gerando informaÃ§Ãµes de build..."
node scripts/build-version.js

if [ $? -eq 0 ]; then
  echo "âœ… InformaÃ§Ãµes de build geradas com sucesso."
else
  echo "âš ï¸  Falha ao gerar informaÃ§Ãµes de build."
fi

echo "âœ… AÃ§Ãµes pÃ³s-commit concluÃ­das!"